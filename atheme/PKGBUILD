pkgname=atheme
pkgver=7.0.2
pkgrel=1
pkgdesc='Atheme IRC services'
url='http://atheme.net/'
license=('ISC')
arch=('x86_64' 'i686')
depends=('libmowgli')
optdepends=('libldap: auth/ldap module')
install=atheme.install

source=(http://atheme.net/downloads/atheme-services-$pkgver.tar.bz2
        atheme.rcd)
sha1sums=('4cf363a067f8d9b0b01c999127748fa3995ad037'
          'c5f8bfa66eb4d0e90f74fbb63d7f4fc50e587211')

build() {
  cd "${srcdir}/atheme-services-${pkgver}"
  ./configure --enable-fhs-paths \
    --prefix=/usr \
    --sysconfdir=/etc/atheme \
    --localstatedir=/var \
    --enable-contrib
  make
}

package() {
  install -Dm755 "${srcdir}"/atheme.rcd "${pkgdir}"/etc/rc.d/atheme

  cd "${srcdir}/atheme-services-${pkgver}"
  make DESTDIR="$pkgdir" install
  chown 142:142 $pkgdir/var/{lib,run}/atheme
  install -Dm 644 $pkgdir/usr/share/doc/atheme/LICENSE $pkgdir/usr/share/licenses/atheme/LICENSE
}
